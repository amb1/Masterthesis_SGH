# CEA Mapping Konfiguration

# Prioritätsreihenfolge der Datenquellen
data_source_priority:
  - citygml  # Höchste Priorität
  - wfs
  - osm      # Niedrigste Priorität

# Zone.shp Mappings
zone_mappings:
  Name:
    sources:
      street: "Gebäudeinfo_STRNAML"
      house_no: "Gebäudeinfo_VONN"
    transform: "combine_address"
    default: "Unknown"
  
  floors_ag:
    sources:
      wfs: "GEBAEUDEINFOOGD_GESCH_ANZ"
      citygml: "measuredHeight"
    transform: "floors_from_height"
    default: 4
    required: true
  
  floors_bg:
    sources:
      wfs: "Gebäudeinfo_NS"
    transform: "to_int"
    default: 1
    required: true
  
  height_ag:
    sources:
      citygml: "measuredHeight"
      wfs: "HoeheDach"
    transform: "to_float"
    default: 12.0
  
  height_bg:
    calculation: "floors_bg * 3"
    transform: "to_float"
    default: 3.0
  
  REFERENCE:
    sources:
      citygml: "gml_id"
    transform: "none"  # Keine Kürzung mehr
  
  house_no:
    sources:
      wfs: "Gebäudeinfo_VONN"
    default: ""
  
  street:
    sources:
      wfs: "Gebäudeinfo_STRNAML"
    default: ""
  
  postcode:
    sources:
      wfs: "Gebäudeinfo_BEZ"
    default: "1010"
  
  house_name:
    sources:
      wfs: "Gebäudeinfo_HA_NAME"
    default: ""
  
  resi_type:
    sources:
      wfs: "Gebäudeinfo_L_NUTZUNG"
      wfs2: "Realnutzung_NUTZUNG_LEVEL1"
    default: ""

# Typology.shp Mappings
typology_mappings:
  Name:
    sources:
      citygml: "gml_id"
    transform: "none"  # Keine Kürzung mehr
  
  YEAR:
    sources:
      wfs: "Gebäudeinfo_BAUJAHR"
    transform: "to_int"
    default: 1960
  
  TYPE:
    sources:
      wfs: "Gebäudeinfo_L_BAUTYP"
      wfs2: "Gebäudetypologie_BAUTYP"
    mapping:
      "Wohngebäude": "MFH"
      "Bürogebäude": "OFFICE"
      "Geschäftsgebäude": "RETAIL"
      "Industriegebäude": "INDUSTRIAL"
      "Öffentliches Gebäude": "PUBLIC"
    default: "MFH"
  
  STANDARD:
    sources:
      wfs: "Gebäudeinfo_L_BAUTYP"
      wfs2: "Gebäudetypologie_BAUTYP_TXT"
    default: "STANDARD"
  
  1ST_USE:
    sources:
      wfs: "Gebäudeinfo_L_NUTZUNG"
    mapping:
      "4.-Bauten der öffentl.u.privaten Repräsentation u.Verwaltung": "OFFICE"
      "5.-Bauten der Erziehung und Bildung": "SCHOOL"
      "6.-Bauten der öffentlichen und privaten Wirtschaft": "OFFICE"
      "10.-Kaufhäuser": "RETAIL"
      "11.-Einkaufszentren": "RETAIL"
      "12.-Gewerbebetriebe": "INDUSTRIAL"
      "13.-Industriebauten": "INDUSTRIAL"
      "14.-Bauten des öffentlichen und privaten Verkehrs": "OFFICE"
      "15.-Bauten der öffentlichen und privaten Wohlfahrt": "OFFICE"
      "W1.1.-bäuerl.dom.Baustrukt.-Streck- u. Hakenhof": "RESIDENTIAL"
      "W1.2.-bäuerl.dom.Baustrukt.-Zwerchh.u.Gassenfrontenhaus": "RESIDENTIAL"
      "W2.1.-Bürgerhaus-kleine Haustypen ohne Hof": "RESIDENTIAL"
      "W2.2.-Bürgerhaus-Haus auf tiefer,schmaler Parzelle,ohne Hof": "RESIDENTIAL"
      "W3.1.-Mieth.s.d.Gründerzeit-Straßentrakter": "RESIDENTIAL"
      "W3.2.-Mieth.s.d.Gründerzeit-Seitenflügelhaus": "RESIDENTIAL"
      "W3.3.-Mieth.s.d.Gründerzeit-Doppeltrakter mit Verbindungstr.": "RESIDENTIAL"
      "W3.4.-Mieth.s.d.Gründerzeit-Doppeltrakter,zweihüft. Hoftrakt": "RESIDENTIAL"
      "W3.7.-Mieth.s.d.Gründerzeit-Eckhaus": "RESIDENTIAL"
      "W3.8.-Mieth.s.d.Gründerzeit-Hoftrakt": "RESIDENTIAL"
      "W4.1.-soz.u.gemeinn.Wohnb.-Baulückenbebauungen": "RESIDENTIAL"
      "W4.2.-soz.u.gemeinn.Wohnb.-Hofbebauungen/Superblocks": "RESIDENTIAL"
      "W4.3.-soz.u.gemeinn.Wohnb.-Siedlungen in Zeilenbauweise": "RESIDENTIAL"
      "W4.4.-soz.u.gemeinn.Wohnb.-Siedlungen,1-,2-u.Mehrfamilienh.": "RESIDENTIAL"
      "W5.1.-freist.1-,2-u.Mehrfamilienh.-Villen in Randbebauung": "RESIDENTIAL"
      "W5.2.-freist.1-,2-u.Mehrfamilienh.-freistehende Villen": "RESIDENTIAL"
      "W6.1.-Sonderwohnbauten-Hotel und Pension": "HOTEL"
      "W6.2.-Sonderwohnbauten-Heim,Pflegeanstalt,Spitalsbauten": "HOSPITAL"
    default: "RESIDENTIAL"
  
  1ST_USE_R:
    transform: "to_float"
    default: 1.0
  
  2ND_USE:
    default: "NONE"
  
  2ND_USE_R:
    default: 0
  
  3RD_USE:
    default: "NONE"
  
  3RD_USE_R:
    default: 0

# Transformationsfunktionen
transformations:
  combine_address:
    description: "Kombiniert Straße und Hausnummer"
    function: "combine_address"
  
  floors_from_height:
    description: "Berechnet Geschosse aus Höhe wenn keine direkte Angabe vorhanden"
    function: "floors_from_height"
    height_per_floor: 3.0
  
  to_int:
    description: "Konvertiert Werte zu Integer"
    function: "to_int"
  
  to_float:
    description: "Konvertiert Werte zu Float"
    function: "to_float"
  
  none:
    description: "Keine Transformation"
    function: "none"

# CEA-Mapping-Definitionen
building_type_mapping:
  residential:
    MFH: "MULTI_FAMILY_HOUSE"
    SFH: "SINGLE_FAMILY_HOUSE"
    APT: "APARTMENT"
  commercial:
    OFFICE: "OFFICE"
    RETAIL: "RETAIL"
    RESTAURANT: "RESTAURANT"
  public:
    SCHOOL: "SCHOOL"
    UNIVERSITY: "UNIVERSITY"
    HOSPITAL: "HOSPITAL"
    GOVERNMENT: "GOVERNMENT"
  industrial:
    INDUSTRIAL: "INDUSTRIAL"
    FACTORY: "FACTORY"
    WAREHOUSE: "WAREHOUSE"
  other:
    OTHER: "OTHER"
    UNKNOWN: "UNKNOWN"

construction_type_mapping:
  SOLID: "MASSIVE_CONSTRUCTION"
  PREFAB: "PREFABRICATED"
  LIGHT: "LIGHT_CONSTRUCTION"
  UNKNOWN: "UNKNOWN"

energy_system_mapping:
  heating:
    DISTRICT: "DISTRICT_HEATING"
    GAS: "GAS_HEATING"
    OIL: "OIL_HEATING"
    ELECTRIC: "ELECTRIC_HEATING"
    HEAT_PUMP: "HEAT_PUMP"
    NONE: "NO_HEATING"
  cooling:
    CENTRAL: "CENTRAL_AC"
    SPLIT: "SPLIT_UNITS"
    DISTRICT: "DISTRICT_COOLING"
    NONE: "NO_COOLING"

# Feld-Mappings
field_mappings:
  # Gebäudehöhe und Geschosse
  floors_ag:
    source: "measuredHeight"
    calculation: "value / 3"
    default: 4
  
  floors_bg:
    source: "NS"
    mapping:
      "K": 1
      "*": 0
    default: 1
  
  # Baujahr
  year:
    sources:
      - field: "L_BAUJ"
        type: "direct"
      - field: "OBJ_STR2_TXT"
        type: "period_mapping"
    default: 1960
  
  # Gebäudetyp und Nutzung
  use_type:
    sources:
      - field: "L_BAUTYP"
        type: "building_type_mapping"
      - field: "BAUTYP_TXT"
        type: "building_type_mapping"
    default: "NONE"
  
  # Adressfelder
  postcode:
    source: "BEZ"
    default: "1010"
  
  house_no:
    source: "VONN"
    default: ""
  
  street:
    source: "STRNAML"
    default: ""
  
  resi_type:
    source: "L_NUTZUNG"
    default: ""
